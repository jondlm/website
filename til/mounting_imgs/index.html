<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="description" content="Jon's personal site."><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/website/favicon.svg?v=2"><link rel="alternate" type="application/rss+xml" title="Chez Jon" href="https://jondlm.github.io/website/rss.xml"><meta name="generator" content="Astro v4.16.3"><title>Mounting paritions from an img file</title><link rel="stylesheet" href="/website/_astro/blog.-JKPVJtT.css"><script type="module" src="/website/_astro/hoisted.CfyTAeD1.js"></script></head> <body class="px-4 md:px-16 lg:px-32 xl:px-64 2xl:px-96 container mx-auto pb-2"> <div id="sentinal" class="h-6"></div> <div id="nav-stripe" class="print:hidden bg-slate-900 top-0 right-full left-0 w-full fixed opacity-0"></div> <nav id="navbar" class="print:hidden flex mb-8 px-2 pr-5 py-2 bg-slate-900 rounded-lg border border-slate-900"> <div class="flex-auto flex items-center"> <a href="/website"> <img src="/website/_astro/home_handwritten.DLN5N5L3_Z1ER9WK.svg" alt="home" loading="eager" width="65" height="25" decoding="async"> </a> </div> <div class="flex flex-auto items-center justify-end space-x-4"> <a class="text-slate-100" href="/website/values">values</a> <a class="text-slate-100" href="/website/blog">blog</a> <a class="text-slate-100" href="/website/til">TIL</a> <a class="text-slate-100" href="/website/resume">resume</a> </div> </nav>  <article class="md"> <h1 class="mb-2">TIL: Mounting paritions from an img file</h1> <div class="flex items-baseline"> <div class="text-gray-500 mt-0 -mr-2 text-sm"> 2025-04-13 </div> <ul> <li class="text-gray-500 text-xs border border-gray-400 rounded-full px-1.5 mr-1 inline-block">fs</li> </ul> </div> <p>My wife got me a little retro gaming device for my birthday today. I turned it on, played around a bit, then reset it. It wouldn’t boot. I did some digging and discovered that the SD card needed to be replaced. I mounted the card on my Linux box and used <code>dd</code> to back it up.</p>
<p>Here’s what I learned/remembered/will learn again:</p>
<ul>
<li><code>dd</code> is used to make direct copies of a device. You can use it to make a backup <code>.img</code> file of a device</li>
<li><code>lsblk</code> lists block devices that may or may not be mounted</li>
<li><code>lsblk -o NAME,FSTYPE</code> is handy cause it’ll show partitions and their file systems</li>
<li><code>fdisk -lu foo.img</code> will show the partitions within the <code>.img</code> and their offsets</li>
</ul>
<p>You can use a loopback mount to mount an <code>.img</code> so you can browse the files in it as if it were plugged in like a drive.</p>
<p>If you need to mount just one of the paritions, you need to run <code>fdisk -lu</code> like this:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plaintext"><code><span class="line"><span>❯ fdisk -lu ~/foo.img</span></span>
<span class="line"><span>Disk /home/jon/foo.img: 7.4 GiB, 7948206080 bytes, 15523840 sectors</span></span>
<span class="line"><span>Units: sectors of 1 * 512 = 512 bytes</span></span>
<span class="line"><span>Sector size (logical/physical): 512 bytes / 512 bytes</span></span>
<span class="line"><span>I/O size (minimum/optimal): 512 bytes / 512 bytes</span></span>
<span class="line"><span>Disklabel type: dos</span></span>
<span class="line"><span>Disk identifier: 0xc9f931c9</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Device                      Boot    Start      End  Sectors  Size Id Type</span></span>
<span class="line"><span>/home/jon/foo.img1         32768   262143   229376  112M  b W95 FAT32</span></span>
<span class="line"><span>/home/jon/foo.img2        262144 13983743 13721600  6.5G 83 Linux</span></span>
<span class="line"><span>/home/jon/foo.img3      13983744 15523839  1540096  752M  7 HPFS/NTFS/exFAT</span></span>
<span class="line"><span></span></span></code></pre>
<p>Suppose I wanted to mount just the <code>Linux</code> parition. I’d do that by using the <code>start</code> as an offset, and <code>512</code> as the sector size from the above <code>fdisk</code> call, with the <code>mount</code> command:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="sh"><code><span class="line"><span style="color:#B392F0">sudo</span><span style="color:#9ECBFF"> mount</span><span style="color:#79B8FF"> -o</span><span style="color:#9ECBFF"> loop,offset=</span><span style="color:#E1E4E8">$((</span><span style="color:#B392F0">512</span><span style="color:#79B8FF"> *</span><span style="color:#79B8FF"> 13983743</span><span style="color:#E1E4E8">)) </span><span style="color:#9ECBFF">/home/jon/foo.img</span><span style="color:#9ECBFF"> /mnt</span></span>
<span class="line"></span></code></pre>
<p>Then it would be available at <code>/mnt</code>.</p>
<p>Side note: at first I went down the path of using <code>losetup</code> to create a loopback device until a Stack Overflow comment reminded me that the <code>-o loop</code> flag on mount can do that for you.</p> </article>   </body></html>